<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../CSS/style.css">
    <script type="text/javascript" src="../JS/script.js"></script>
    <title></title>
  </head>
  <body>

    <h1 class="brand">
      <a href="../HTML/catalog.html">VHS Pro :)</a>

      <form id="form1" class="search" action="../PHP/search.php">
        <input type="text" class="area" name="search" value="" placeholder="Поиск...">
        <a href="javascript: search()" class="button"> <img src="../IMG/search.png" alt=""> </a>
      </form>

      <a class="back" href="../HTML/index.html">Назад</a>
    </h1>

    <!-- меню товаров -->
    <main>
      <script type="text/javascript">
        main = document.querySelector('main')

        var film_count = +localStorage.getItem("film_id")
        console.log(film_count)
        film1_ls = localStorage.getItem('film1')
        film1_ls = JSON.parse(film1_ls)
        console.log(film1_ls)

        films_arr_ls = []
        for (var i = 1; i <= film_count; i++) {
          let film_current = 'film' + i
          if (localStorage.getItem(film_current)!=null) {
            film = localStorage.getItem(film_current)
            film_ls = JSON.parse(film)
            films_arr_ls.push(film_ls)
          }
          // film = localStorage.getItem('film' + i)
          // film_ls = JSON.parse(film)
          // films_arr_ls.push(film_ls)
        }
        console.log(films_arr_ls)

        for (var i = 0; i < films_arr_ls.length; i++) {
          // fund.films_arr[i]
          main.innerHTML += `<div class="row">
            <p class="pic">
              <img src="../IMG/dvd.jpg" >
            </p>
            <div class="info">
              <p class="name">
                ${films_arr_ls[i].title}
              </p>
              <div class="details">
                <p class="genre">
                  Жанр: ${films_arr_ls[i].genre}
                </p>
                <p class="persons">
                  Персоны: ${films_arr_ls[i].persons.reduce((x, item) =>
                    x += item + '; ', ' ')
                  }
                </p>
                <p class="production">
                  Компания: ${films_arr_ls[i].production.slice(0,films_arr_ls[i].production.indexOf(','))}
                </p>
                <p class="country">
                  Страна: ${films_arr_ls[i].production.slice(films_arr_ls[i].production.indexOf(',')+2)}
                </p>
                <p class="type">
                  Формат: ${films_arr_ls[i].type}
                </p>
                <p class="amount">
                  Количество: ${films_arr_ls[i].amount}
                </p>
              </div>
            </div>
            <div class="buttons_block">
              <p class="price">
                Цена: ${films_arr_ls[i].price}
              </p>
              <a href="#" class="button fav"><img src="../IMG/fav.png"></a>
              <a href="#" class="button buy"><img src="../IMG/buy.png"></a>
            </div>
          </div>`
        }
      </script>
    </main>

 <form id="form2" action="../PHP/item_page.php" method="post" hidden>
   <input type="text" id="crutch" name="crutch" hidden>
 </form>

<script type="text/javascript">

</script>

</body>
